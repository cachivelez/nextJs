{"version":3,"file":"4.4f48d78042f8ee8e6d3b.hot-update.js","sources":["webpack:///pages/index.js"],"sourcesContent":["import 'isomorphic-fetch'\r\nimport LayoutFull from '../components/layout/LayoutFull'\r\nimport {Link} from'../routes';\r\nimport Error from './_error'\r\n\r\n// components\r\nimport Hero from '../components/hero'\r\nimport Catalogue from '../components/catalogue'\r\n\r\nexport default class extends React.Component{\t\r\n\tconstructor(props) {\r\n\t  \tsuper(props);\r\n\t\tthis.handleClickAddCoins = this.handleClickAddCoins.bind(this);\r\n\t\tthis.state = {\r\n\t\t\tuser: null,\r\n\t\t\tproducts: null,\r\n\t\t\tstatusCode: null\r\n\t\t}\r\n\t}\r\n\r\n\tstatic async getInitialProps({ res }){\t\t\r\n\t\ttry {\r\n\t\t\tlet [reqUser, reqProducts] = await Promise.all([\r\n\t\t        fetch(`https://aerolab-challenge.now.sh/user/me?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1Yjc2NTVjNGYyYjBlNzAwNTc5ZDgzODEiLCJpYXQiOjE1MzQ0ODE4NjB9.qthyWAKLfbrB-HQ9R26z8DAn-jfHrH4xOsQSwGCaiNk`),\r\n\t\t        fetch(`https://aerolab-challenge.now.sh/products?token=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1Yjc2NTVjNGYyYjBlNzAwNTc5ZDgzODEiLCJpYXQiOjE1MzQ0ODE4NjB9.qthyWAKLfbrB-HQ9R26z8DAn-jfHrH4xOsQSwGCaiNk`)\r\n\t\t    ])\r\n\t\t\tif( reqUser.status >= 400 ) {\r\n\t\t        return { user: null, products: null, statusCode: req.status }\r\n\t\t    }\r\n\r\n\t\t    let user = await reqUser.json()\r\n\t\t    let products = await reqProducts.json()\r\n\r\n\t\t\treturn { user, products, statusCode: 200 }\t\r\n\t\t} catch(e){\r\n\t\t\tres.statusCode = 503\r\n\t\t\treturn { user: null, products: null, statusCode: 503 }\t\r\n\t\t}\t\t\r\n\t}\r\n\r\n\tasync handleClickAddCoins(arg){\r\n\t\ttry {\r\n\t\t\tlet reqPoints = await fetch('https://aerolab-challenge.now.sh/user/points', {\r\n\t\t        method: 'POST',\r\n\t\t        body: JSON.stringify({amount: 1000}),\r\n\t\t        headers: {\r\n\t\t            'Content-Type': 'application/json',\r\n\t\t            'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI1Yjc2NTVjNGYyYjBlNzAwNTc5ZDgzODEiLCJpYXQiOjE1MzQ0ODE4NjB9.qthyWAKLfbrB-HQ9R26z8DAn-jfHrH4xOsQSwGCaiNk'\r\n\t\t        }\r\n\t    })\r\n\r\n\t    if( reqPoints.status >= 400 ) {\r\n\t\t    alert('Error') \r\n\t    }\r\n\r\n\t    let coins = await reqPoints.json()\r\n\t    alert(coins.message)\t    \r\n\t    this.props.user.points = this.props.user.points + 1000 \r\n\t    this.setState({\r\n\t    \tuser: this.props.user\r\n\t    })\r\n\r\n\t    } catch(e){\r\n\t\t\talert('Error')\r\n\t\t}\r\n\t}\r\n\r\n\trender(){\r\n\t\tconst { user, products, statusCode } = this.props\r\n\r\n\t\tthis.setState({\r\n\t\t\tuser: user,\r\n\t\t\tproducts: products,\r\n\t\t\tstatusCode: statusCode\r\n\t\t})\r\n\r\n\t\tif( statusCode !== 200 ) {\r\n\t      return <Error statusCode={ statusCode } />\r\n\t    }\t\r\n\r\n\t\treturn <LayoutFull user={user.name} coins={user.points} title=\"Catalogue\" eventAddCoins={this.handleClickAddCoins}>\r\n\t\t\t<Hero />\r\n\t\t\t<Catalogue user={user} products={products}/>\r\n\t\t</LayoutFull>\r\n\t}\r\n}\n\n\n// WEBPACK FOOTER //\n// pages/index.js"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;;;;;AAEA;AAAA;AACA;AADA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAHA;AAHA;AAQA;AACA;;;;;;AAqBA;;;;;;;;AAEA;AACA;AACA;AAAA;AAAA;AACA;AACA;AACA;AAFA;AAHA;AACA;;AADA;AACA;AAQA;AACA;AACA;AACA;;AACA;AACA;;AADA;AACA;AACA;AACA;AACA;AADA;;;;;;;AAKA;AACA;;;;;;;;;;;;;;;AAGA;AAAA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AAHA;AACA;AAKA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;;;;;;;;;;;;;AAhEA;;;AAEA;AACA;;;;AADA;AAAA;AACA;AAGA;;;;;AACA;AAAA;AAAA;AAAA;AAAA;AACA;;;AAEA;AACA;;AADA;;AACA;AACA;;AADA;AAEA;AAAA;AAAA;AAAA;AAAA;AACA;;;;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;;;;;;;;;;;;;;;;AA5BA;AACA;;;;;;;;;;;;;;;;;;;;;;;;A","sourceRoot":""}